## 결정트리와 앙상블 

이번 챕터에서는 결정트리에 대해서 알아봄   
사실 결정트리에는 굉장히 큰 단점이 있음  ==> 부정확성   
다른 모델들에 비해 성능이 안좋음    
근데 왜 결정트리를 배울까?  ==> 결정트리를 응용하면 성능이 좋은 다른 모델들을 만들 수 있음 

### 앙상블 (ensemble)  
: 하나의 모델을 쓰는 대신 수많은 모델들을 사용해 종합적인 판단을 하는 것 

예시)  


![](/image.png/07.28.PNG)  


주어진 데이터셋에서 타이타닉 탑승자의 생존 or 사망을 예측하는 프로그램읆 만든다고 하자   

학습데이터를 이용해서 100개의 모델을 만들자    
그러면 탑승자가 죽을지 살지에 대한 예측이 총 100개 만들어짐    

예측값을 투표를 통해 결정   
==> 모델 70개가 탑승자가 생존을 예측하고 30개가 사망을 예측하면 생존으로 분류  

다수결 투표는 앙상블의 한 예시    

수많은 모델들을 만들고 이 모델들의 예측을 합쳐서 종합적인 예측을 하는 기법 

결정트리와 앙상블을 합치면 결정트리 하나를 사용하는 것보다 성능이 훨씬 좋은 모델들을 만들 수 있음      

## 랜덤 포레스트 1: Bagging 
: 수많은 결정 트리 모델들을 임의로 만들고 모델들의 결과를 다수결 투표로 종합하여 예측하는 모델    

임의성을 더하는 요소 2가지 

 먼저 bootstrappig : 갖고 있는 데이터 셋을 이용해서 다른 데이터 셋을 만드는 방법  

예시)  독감환자 데이터셋   

원래 있던 데이터 셋에서 임의로 데이터를 가지고 와서 새 데이터셋에 추가해주면 됨  

![](/image.png/07.29.PNG)  

중복 가능 , 안쓰는 데이터도 존재  
이렇게 만들어낸 데이터를 bootstrap 데이터셋이라고 함 

만드는 이유는?  

 모든 모델을 정확히 똑같은 데이터 셋으로 학습시키면 결과의 다양성이 떨어질 수 있음 
이 문제를 방지하기 위해서 각 모델을 임의로 만들어준 bootstrap 데이터 셋으로 학습시킴  
   
모든 앙상블 머신러닝 알고리즘들이 부트스트랩을 쓰는 건 아님   

부트스트랩 데이터셋을 만들어내고 모델들의 결정들을 종합해서 예측을 하는 앙상블 기법을 
bootstrap aggregating 줄여서 Bagging이라고 함     

이번 챕터에서 다루는 랜포는 배깅을 사용하는 여러 알고리즘 중 하나의 예시!  


## 랜덤포레스트 2: 임의로 결정 트리 만들기  

결정트리를 그냥 만들 때는 각 속성들을 사용한 질문들의 지니불순도를 구하고 가장 낮을 얘를 골라서 샤용  

그러나 랜포를 만들 때는 4가지 속성 중 2개를 임의로 고름  

(사실 속성이 많을 때는 임의로 3개나 4개를 고를 수도 있음)  


고열과 기침을 사용한다고 하자       

![](/image.png/07.30.PNG)  


그 다음 이 두 개의 속성들을 사용하는 질문들의 불순도를 비교해서 둘 중 더 좋은 것을 루트노드의 질문으로 정함    


![](/image.png/07.31.PNG)  

고열이 있나요?를 골랐다고 하자     
그다음 또다시 2개의 속성을 임의로 골라서 불순도를 비교해서 가장 낮은 걸 질문노드로 사용   

![](/image.png/07.32.PNG)  



결정트리를 만드는 것 자체는 원래와 다르지 않음   
매 노드를 만들 때 어느 정도는 임의로 만들기 때문에 수많은 서로 다른 결정트리들이 나올 수 있음  


요약  


![](/image.png/07.33.PNG)  



100번 했다고 하자  
그러면 서로 조금 씩 다른 100개의 결정트리를 만들 수 있음  



![](/image.png/07.34.PNG)  




랜포를 사용해서 예측할 때는 만들어놓은 트리들의 예측을 다수결 투표로 종합해서 결정   

예를 들어,  
데이터를 100개의 트리에 각각 넣어줌 그리고 독감을 예측하는 트리의 수가 40개, 일반감기를 예측하는 트리의 수가 60개면 일반 감기로 예측값을 리턴  

### 파이썬 실습 생략  

RandomForestClassifier()에서 optional parameter 2가지만 정리  

 - n_estimator : 결저읕리 몇 개 만들지 기본값은 10 
 - max_depth : 만들 트리들의 최대 깊이  
 
 